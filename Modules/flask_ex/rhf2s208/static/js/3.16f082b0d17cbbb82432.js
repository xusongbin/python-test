webpackJsonp([3],{D1i8:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("TJdQ"),a={name:"server",data:function(){return{serverActiveName:"iotsquare",sdkOpenSw:!1,bridgeParam:{gatewayId:"",mqttServer:"",httpServer:""}}},computed:{bridgeRules:function(){var t=this;return{gatewayId:[{required:!0,message:this.$t("server.gatewayIdRules"),trigger:"blur"},{required:!0,validator:function(e,r,n){!t.str16Sw(r)&&n(new Error(t.$t("main.no16str"))),n()},trigger:"blur"},{required:!0,validator:function(e,r,n){16!=r.length&&n(new Error(t.$t("main.str16"))),n()},trigger:"blur"}],mqttServer:[{required:!0,message:this.$t("server.mqttServerRules"),trigger:"blur"},{required:!0,validator:function(e,r,n){!t.urlPortExamine(r)&&n(new Error(t.$t("main.urlRules"))),n()},trigger:"blur"}],httpServer:[{required:!0,message:this.$t("server.httpServerRules"),trigger:"blur"},{required:!0,validator:function(e,r,n){!t.urlExamine(r)&&n(new Error(t.$t("main.urlRules"))),n()},trigger:"blur"}]}},bridgeContentItem:function(){return{mqttServer:{title:this.$t("server.mqttServerTitle"),content:[this.$t("server.mqttServerContent1"),this.$t("server.mqttServerContent2")]},httpServer:{title:this.$t("server.httpServerTitle"),content:[this.$t("server.httpServerContent1"),this.$t("server.httpServerContent2"),this.$t("server.httpServerContent3")]}}}},methods:{urlPortExamine:function(t){return/^(tls|tcp)?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d{1,5}$)/.test(t)},urlExamine:function(t){return/^(https|http)?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d{1,5})?$/.test(t)},str16Sw:function(t){return/^[0-9a-fA-F]{1,}$/.test(t)},serverTabsClick:function(t){this.serverActiveName=t.toString()},enableRhfBridge:function(t){var e=this;this.$Message.loading({content:this.$t("lorawan.updateLoraLoading"),duration:0}),this.$refs[t].validate(function(t){if(t){var r=e.bridgeParam.gatewayId,a=e.bridgeParam.mqttServer,i=e.bridgeParam.httpServer;Object(n.d)({gateway_id:r,mqtt_server:a,http_server:i}).then(function(t){e.$Message.destroy(),"0"==t.data.result?(e.queryRhfBridgeStatus(),e.$Message.success(e.$t("lorawan.lorawanConfigSuccess"))):e.$Message.error(e.$t("lorawan.lorawanConfigErr"))})}else e.$Message.destroy()})},disableRhfBridge:function(){var t=this;this.$Message.loading({content:this.$t("lorawan.lorawanCloseLoading"),duration:0}),Object(n.b)().then(function(e){t.$Message.destroy(),0==e.data.result?(t.queryRhfBridgeStatus(),t.$Message.success(t.$t("lorawan.lorawanCloseSuccess"))):t.$Message.error(t.$t("lorawan.lorawanCloseErr"))})},queryRhfBridgeStatus:function(){var t=this;Object(n.n)().then(function(e){if(0==e.data.result){var r=e.data.data.status;t.sdkOpenSw=!1,"enable"==r&&(t.sdkOpenSw=!0)}})},getRhfBridge:function(){var t=this;Object(n.k)().then(function(e){if(0==e.data.result){var r=e.data.data;t.bridgeParam={gatewayId:r.gateway_id,mqttServer:r.mqtt_server,httpServer:r.http_server}}})}},mounted:function(){this.getRhfBridge(),this.queryRhfBridgeStatus()}},i={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"server"},[r("Tabs",{attrs:{animated:!1,value:t.serverActiveName},on:{"on-click":t.serverTabsClick}},[r("TabPane",{attrs:{label:"Iotsquare Bridge",name:"iotsquare"}},[r("Form",{ref:"bridgeParam",staticStyle:{padding:"16px"},attrs:{model:t.bridgeParam,"label-width":120,rules:t.bridgeRules}},[r("FormItem",{staticClass:"alerts"},[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                        "+t._s(t.$t("wifi.iotBridgeExplain"))+"\n                        "),r("template",{slot:"desc"},[r("p",[t._v(t._s(t.$t("wifi.iotBridgeDescOne"))+" ("),r("a",{attrs:{href:"https://iotsquare.xyz/",target:"_blank"}},[t._v(" https://iotsquare.xyz ")]),t._v(")")]),t._v(" "),r("p",[t._v(t._s(t.$t("wifi.iotBridgeDescTwo")))]),t._v(" "),r("p",[t._v(t._s(t.$t("wifi.iotBridgeDescThree")))])])],2)],1),t._v(" "),r("FormItem",{attrs:{prop:"gatewayId",label:t.$t("lorawan.GWID")}},[r("Input",{attrs:{type:"text",placeholder:t.$t("server.gatewayIdPlace")},model:{value:t.bridgeParam.gatewayId,callback:function(e){t.$set(t.bridgeParam,"gatewayId",e)},expression:"bridgeParam.gatewayId"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"mqttServer",label:t.$t("server.mqttServerAddr")}},[r("Poptip",{attrs:{"word-wrap":"",width:"500",placement:"top-start",trigger:"focus"}},[r("h3",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.bridgeContentItem.mqttServer.title))]),t._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("ul",t._l(t.bridgeContentItem.mqttServer.content,function(e,n){return r("li",{key:n},[t._v(t._s(n+1+"、"+e))])}),0)]),t._v(" "),r("Input",{attrs:{type:"text",placeholder:t.$t("server.mqttServerPlace")},model:{value:t.bridgeParam.mqttServer,callback:function(e){t.$set(t.bridgeParam,"mqttServer",e)},expression:"bridgeParam.mqttServer"}})],1)],1),t._v(" "),r("FormItem",{attrs:{prop:"httpServer",label:t.$t("server.httpServerAddr")}},[r("Poptip",{attrs:{"word-wrap":"",width:"500",placement:"top-start",trigger:"focus"}},[r("h3",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.bridgeContentItem.httpServer.title))]),t._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("ul",t._l(t.bridgeContentItem.httpServer.content,function(e,n){return r("li",{key:n},[t._v(t._s(n+1+"、"+e))])}),0)]),t._v(" "),r("Input",{attrs:{type:"text",placeholder:t.$t("server.httpServerPlace")},model:{value:t.bridgeParam.httpServer,callback:function(e){t.$set(t.bridgeParam,"httpServer",e)},expression:"bridgeParam.httpServer"}})],1)],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.enableRhfBridge("bridgeParam")}}},[t._v(t._s(t.sdkOpenSw?t.$t("lorawan.reboot"):t.$t("lorawan.open")))]),t._v(" "),t.sdkOpenSw?r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"dashed",ghost:""},on:{click:t.disableRhfBridge}},[t._v(t._s(t.$t("lorawan.close")))]):t._e()],1)],1)],1)],1)],1)},staticRenderFns:[]};var s=r("C7Lr")(a,i,!1,function(t){r("Dcn3")},null,null);e.default=s.exports},Dcn3:function(t,e){},TJdQ:function(t,e,r){"use strict";r.d(e,"m",function(){return a}),r.d(e,"f",function(){return i}),r.d(e,"i",function(){return s}),r.d(e,"h",function(){return o}),r.d(e,"s",function(){return u}),r.d(e,"o",function(){return d}),r.d(e,"a",function(){return l}),r.d(e,"j",function(){return c}),r.d(e,"p",function(){return g}),r.d(e,"l",function(){return f}),r.d(e,"e",function(){return v}),r.d(e,"q",function(){return m}),r.d(e,"t",function(){return h}),r.d(e,"c",function(){return p}),r.d(e,"k",function(){return b}),r.d(e,"d",function(){return w}),r.d(e,"b",function(){return q}),r.d(e,"n",function(){return _}),r.d(e,"g",function(){return S}),r.d(e,"r",function(){return $});var n=r("xXZE"),a=function(){return n.a.request({url:"/cgi-bin/lora/loadLoraMenu.cgi",method:"get"})},i=function(){return n.a.request({url:"/cgi-bin/devInfo/getDevModel.cgi",method:"get"})},s=function(t){var e={basedir:t.basedir};return n.a.request({url:"/cgi-bin/lora/getPktfwdCfgDir.cgi",params:e,method:"get"})},o=function(t){var e={sdk_name:t.sdk_name};return n.a.request({url:"/cgi-bin/lora/getPktfwdCfg.cgi",params:e,method:"get"})},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n.a.request({url:"/cgi-bin/lora/updatePktfwdCfg.cgi",params:t,method:"get"})},d=function(){return n.a.request({url:"/cgi-bin/lora/queryUsePktfwd.cgi",method:"get"})},l=function(){return n.a.request({url:"/cgi-bin/lora/disablePktfwd.cgi",method:"get"})},c=function(t){var e={basedir:t.basedir,dir:t.dir};return n.a.request({url:"/cgi-bin/lora/getPktfwdCfgGlobal.cgi",params:e,method:"get"})},g=function(t){var e={fmin:t.fmin,fmax:t.fmax,fstep:t.fstep};return n.a.request({url:"/cgi-bin/lora/startRssi.cgi",params:e,method:"get"})},f=function(){return n.a.request({url:"/cgi-bin/lora/getRssi.cgi",method:"get"})},v=function(){return n.a.request({url:"/cgi-bin/lora/getAliotCfg.cgi",method:"get"})},m=function(t){return n.a.request({url:"/cgi-bin/lora/updateAliotCfg.cgi",params:t,method:"get"})},h=function(){return n.a.request({url:"/cgi-bin/lora/updateRhfPktfwdCfg.cgi",method:"get"})},p=function(){return n.a.request({url:"/cgi-bin/lora/disableRhfPktfwd.cgi",method:"get"})},b=function(){return n.a.request({url:"/cgi-bin/server/getRhfBridge.cgi",method:"get"})},w=function(t){var e="gateway_id="+t.gateway_id+"&mqtt_server="+t.mqtt_server+"&http_server="+t.http_server;return n.a.request({url:"/cgi-bin/server/enableRhfBridge.cgi",data:e,method:"post"})},q=function(){return n.a.request({url:"/cgi-bin/server/disableRhfBridge.cgi",method:"get"})},_=function(){return n.a.request({url:"/cgi-bin/server/queryRhfBridgeStatus.cgi",method:"get"})},S=function(){return n.a.request({url:"/cgi-bin/lora/getLoriotCfg.cgi",method:"get"})},$=function(t){var e={address:t.address};return n.a.request({url:"/cgi-bin/lora/updateLoriotCfg.cgi",params:e,method:"get"})}}});